<div class="row">
  <div class="col col-md-10 offset-md-1">
    <div class="d-flex justify-content-between mb-3">
      <h2 class="fw-bold text-primary text-start">My bookings</h2>
    </div>
  </div>
  <div class="col col-md-10 offset-md-1">
    <% if !@bookings.present? %>
    <div class="alert alert-info" role="alert">No bookings found</div>
    <% else %>
    <table class="table align-middle mb-0 bg-white">
      <thead class="bg-light">
        <tr>
          <th>Name</th>
          <th>Start Date</th>
          <th>End Date</th>
          <th>Days</th>
          <th>Total Price</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @bookings.each do |b| %>
        <tr>
          <td>
            <div class="d-flex align-items-center">
              <% if b.product.image.attached? %>
              <%= image_tag url_for(b.product.image), class: "rounded-circle img-contain", style: "width: 45px; height: 45px" %>
              <% end %>
              <div class="ms-3">
                <%= link_to b.product.title, product_path(b.product), class: "fw-bold mb-1", role: "button" %>
                <p class="text-muted mb-0"><%= b.product.product_type.name %></p>
              </div>
            </div>
          </td>
          <td>
            <p class="fw-normal mb-1"><%= b.start_date %></p>
          </td>
          <td>
            <p class="fw-normal mb-1"><%= b.end_date %></p>
          </td>
          <td>
            <p class="fw-normal mb-1"><%= b.num_days %></p>
          </td>
          <td>
            <p class="fw-normal mb-1"><%= render "shared/currency", amount: b.booked_price * b.num_days %></p>
          </td>
          <td>
            <span class="badge <%= "badge-warning" if b.pending? %> <%= "badge-success" if b.confirmed? %> <%= "badge-danger" if b.cancelled? %> <%= "badge-info" if b.completed? %> rounded-pill d-inline"><%= b.status.capitalize %></span>
          </td>
          <td>
            <%= link_to "View", booking_path(id: b), class: "btn btn-link btn-sm btn-rounded", role: "button" %>
            <% if b.pending? %>
            <%= link_to "Pay", new_payment_path(id: b), class: "btn btn-link btn-sm btn-rounded", role: "button" %>
            <% end %>

            <% if b.pending? || (b.confirmed? && !b.started?)%>
            <%= button_to "Cancel", booking_path(b), method: :delete, data: { turbo_confirm: "Do you want to delete the booking?" }, class: "btn btn-link btn-sm btn-rounded", role: "button" %>
            <% end %>

            <% if b.confirmed? %>
            <%= link_to "Print", print_booking_path(b), target: "_blank", class: "btn btn-link btn-sm btn-rounded", role: "button" %>
            <% end %>
          </td>
        </tr>
        <% end %>
      </tbody>
    </table>
    <% end %>
  </div>
</div>